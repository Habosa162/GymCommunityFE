<!-- Class Timetable Section Begin -->
<section class="class-timetable-section spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <div class="section-title">
                    <span>Find Your Time</span>
                    <h2>Find Your Time</h2>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="table-controls">
                    <ul>
                        <li [class.active]="filterType === 'all'" (click)="setFilter('all')">All event</li>
                        <li [class.active]="filterType === 'fitness'" (click)="setFilter('fitness')">Fitness tips</li>
                        <li [class.active]="filterType === 'motivation'" (click)="setFilter('motivation')">Motivation</li>
                        <li [class.active]="filterType === 'workout'" (click)="setFilter('workout')">Workout</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="class-timetable">
                    <table>
                        <thead>
                            <tr>
                                <th></th>
                                <th>Monday</th>
                                <th>Tuesday</th>
                                <th>Wednesday</th>
                                <th>Thursday</th>
                                <th>Friday</th>
                                <th>Saturday</th>
                                <th>Sunday</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let timeSlot of timeSlots; let i = index">
                                <td class="class-time">{{ timeSlot.time }}</td>
                                <td *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']; let j = index"
                                    [class.dark-bg]="getFilteredPlans(timeSlot.id, day).length > 0 && (i + j) % 2 === 0"
                                    [class.hover-bg]="getFilteredPlans(timeSlot.id, day).length > 0"
                                    [class.ts-meta]="getFilteredPlans(timeSlot.id, day).length > 0"
                                    [attr.data-tsmeta]="getFilteredPlans(timeSlot.id, day).length > 0 ? getPlanType(getFilteredPlans(timeSlot.id, day)[0]) : null"
                                    [class.blank-td]="getFilteredPlans(timeSlot.id, day).length === 0"
                                    [class.dark-bg]="getFilteredPlans(timeSlot.id, day).length === 0 && (i + j) % 2 === 0"
                                    class="cell-container">
                                    <ng-container *ngIf="getFilteredPlans(timeSlot.id, day).length > 0">
                                        <h5>{{ getPlanActivity(getFilteredPlans(timeSlot.id, day)[0]) }}</h5>
                                        <span>{{ getPlanTrainer(getFilteredPlans(timeSlot.id, day)[0]) }}</span>
                                    </ng-container>
                                    <ng-container *ngIf="getFilteredPlans(timeSlot.id, day).length === 0">
                                        <div class="cross-icon">Ã—</div>
                                        <button class="add-plan-btn" (click)="openAddPlanModal(timeSlot.id, day)">
                                            <i class="fa fa-plus"></i> Add Plan
                                        </button>
                                    </ng-container>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="add-row-container">
                    <div class="week-input-container">
                        <input type="text" [(ngModel)]="newWeekName" placeholder="Enter week name" class="week-name-input">
                        <button class="add-row-btn" (click)="addNewTimeSlot()">
                            <i class="fa fa-plus"></i> Add New Week
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Class Timetable Section End -->

<!-- Add Plan Popup -->
<div class="add-plan-popup" *ngIf="showAddPlanPopup">
    <div class="popup-overlay" (click)="closeAddPlanPopup()"></div>
    <div class="popup-content">
        <div class="popup-header">
            <h3>Add Daily Plan</h3>
            <button class="close-btn" (click)="closeAddPlanPopup()">&times;</button>
        </div>
        <div class="popup-body">
            <form (ngSubmit)="submitDailyPlan()">
                <div class="form-row">
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" [(ngModel)]="newPlan.date" name="date" required>
                    </div>
                    <div class="form-group">
                        <label>Time Slot</label>
                        <input type="text" [value]="selectedTimeSlot" disabled>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Day</label>
                        <input type="text" [value]="selectedDay" disabled>
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select [(ngModel)]="newPlan.type" name="type" required>
                            <option value="fitness">Fitness</option>
                            <option value="workout">Workout</option>
                            <option value="motivation">Motivation</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Activity</label>
                    <input type="text" [(ngModel)]="newPlan.activity" name="activity" required>
                </div>
                <div class="form-group">
                    <label>Trainer</label>
                    <input type="text" [(ngModel)]="newPlan.trainer" name="trainer" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" (click)="closeAddPlanPopup()">Cancel</button>
                    <button type="submit" class="submit-btn">Add Plan</button>
                </div>
            </form>
        </div>
    </div>
</div>